<?xml version="1.0" encoding="iso-8859-1" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" 
"http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd" > 
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>Scalar &#x0028;Digital&#x0029; Quantization</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<meta name="generator" content="TeX4ht (https://tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (https://tug.org/tex4ht/)" /> 
<!-- xhtml,mathml,html --> 
<meta name="src" content="index.tex" /> 
<link rel="stylesheet" type="text/css" href="index.css" /> 
</head><body 
>
   <div class="maketitle">
                                                                  

                                                                  
                                                                  

                                                                  

<h2 class="titleHead"><a 
href="https://github.com/vicente-gonzalez-ruiz/scalar_quantization" >Scalar &#x0028;Digital&#x0029; Quantization</a></h2>
 <div class="author" ><span 
class="ecrm-1200">Vicente Gonz</span><span 
class="ecrm-1200">&#x00E1;</span><span 
class="ecrm-1200">lez Ruiz</span></div><br />
<div class="date" ><span 
class="ecrm-1200">December 4, 2022</span></div>
   </div>
   <h3 class="likesectionHead"><a 
 id="x1-1000"></a>Contents</h3>
   <div class="tableofcontents">
   &#x00A0;<span class="sectionToc" >1 <a 
href="#x1-20001" id="QQ2-1-2">De&#xFB01;nition</a></span>
<br />   &#x00A0;<span class="sectionToc" >2 <a 
href="#x1-30002" id="QQ2-1-4">Uniform SQ &#x0028;USQ&#x0029;</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >2.1 <a 
href="#x1-40002.1" id="QQ2-1-5">Mid-rise USQ</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >2.2 <a 
href="#x1-50002.2" id="QQ2-1-7">Mid-tread USQ</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >2.3 <a 
href="#x1-60002.3" id="QQ2-1-9">Mid-tread USQ with deadzone</a></span>
<br />   &#x00A0;<span class="sectionToc" >3 <a 
href="#x1-70003" id="QQ2-1-11">Non-uniform quantization</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >3.1 <a 
href="#x1-80003.1" id="QQ2-1-12">Companded quantization&#x00A0;&#x005B;6&#x005D;</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >3.2 <a 
href="#x1-90003.2" id="QQ2-1-14">PDF-optimized quantization</a></span>
<br />   &#x00A0;<span class="sectionToc" >4 <a 
href="#x1-100004" id="QQ2-1-16">Adaptive quantization</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >4.1 <a 
href="#x1-110004.1" id="QQ2-1-17">Forward adaptive quantization</a></span>
<br />   &#x00A0;<span class="sectionToc" >5 <a 
href="#x1-140005" id="QQ2-1-20">Backward adaptive quantization</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >5.1 <a 
href="#x1-170005.1" id="QQ2-1-23">The Jayant quantizer&#x00A0;&#x005B;4&#x005D;</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >5.2 <a 
href="#x1-180005.2" id="QQ2-1-24">Adapting with a scale factor</a></span>
<br />   &#x00A0;<span class="sectionToc" >6 <a 
href="#x1-190006" id="QQ2-1-25">RD performance</a></span>
<br />   &#x00A0;<span class="sectionToc" >7 <a 
href="#x1-200007" id="QQ2-1-26">Perceptual quantization</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >7.1 <a 
href="#x1-210007.1" id="QQ2-1-27">In audio</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >7.2 <a 
href="#x1-220007.2" id="QQ2-1-28">In images</a></span>
<br />   &#x00A0;<span class="sectionToc" >8 <a 
href="#x1-230008" id="QQ2-1-29">Quantization error</a></span>
<br />   &#x00A0;<span class="sectionToc" >9 <a 
href="#x1-240009" id="QQ2-1-30">RD optimized quantizer design</a></span>
<br />   &#x00A0;<span class="sectionToc" >10 <a 
href="#x1-2500010" id="QQ2-1-31">Resources</a></span>
<br />   &#x00A0;<span class="sectionToc" ><a 
href="#Q1-1-32">References</a></span>
   </div>
                                                                  

                                                                  
<!--l. 10--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-20001"></a>De&#xFB01;nition</h3>
<!--l. 13--><p class="noindent" >Scalar &#x0028;Digital&#x0029; <a 
href="https://en.wikipedia.org/wiki/Quantization_(signal_processing)" >Quantization</a>&#x00A0;<span class="cite">&#x005B;<a 
href="#Xsayood2017introduction">6</a>,&#x00A0;<span 
class="ecbx-1000">?</span>&#x005D;</span> &#x0028;see Figure&#x00A0;<a 
href="#x1-2001r1">1<!--tex4ht:ref: fig:Q --></a>&#x0029; is a technique in which each source sample
is quantized independently from the other samples and therefore, a quantization index
<!--l. 17--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mstyle mathvariant="bold"><mi 
>k</mi></mstyle></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math> is produced for each
input sample <!--l. 18--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mstyle mathvariant="bold"><mi 
>s</mi></mstyle></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math>&#x00A0;<span class="cite">&#x005B;<a 
href="#Xvruiz__signal_quantization">2</a>&#x005D;</span>.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
                                                                  

                                                                  
<!--l. 21--><p class="noindent" ><div style="text-align:center;"> <img width=300pt src="graphics/Q.svg" /> </div>  <a 
 id="x1-2001r1"></a>
<a 
 id="x1-2002"></a>
<br />                                                                  </p><div class="caption" 
><span class="id">
Figure&#x00A0;1: </span><span  
class="content">Scalar quantization and dequantization of a signal.
</span></div><!--tex4ht:label?: x1-2001r1 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
<!--l. 26--><p class="indent" >   A <!--l. 26--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>K</mi></math>-levels Scalar
Quantizer &#x0028;SQ&#x0029; <!--l. 26--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Q</mi></math> performs a
partition of the domain of <!--l. 27--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="bold"><mi 
>s</mi></mstyle></math>
into <!--l. 27--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>K</mi></math> cells
<!--l. 27--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mstyle mathvariant="bold"><mi 
>C</mi></mstyle></mrow><mrow 
><mi 
>k</mi></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mi 
>k</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-rel">&#x22EF;</mo><mspace width="0.17em" class="thinspace"/><mo 
class="MathClass-punc">,</mo><mi 
>K</mi></math> and associates
to any <!--l. 28--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mstyle mathvariant="bold"><mi 
>s</mi></mstyle></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math> the
quantization index <!--l. 28--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mstyle mathvariant="bold"><mi 
>k</mi></mstyle></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math>
if <!--l. 29--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mstyle mathvariant="bold"><mi 
>s</mi></mstyle></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">&#x2208;</mo><msub><mrow 
><mstyle mathvariant="bold"><mi 
>C</mi></mstyle></mrow><mrow 
><mi 
>k</mi></mrow></msub 
></math>. In
other words, </p><table class="equation"><tr><td>
<!--l. 30--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                    <mstyle 
   id="x1-2003r1"  class="label" ></mstyle><!--endlabel--><mo 
class="MathClass-open" stretchy="false">Q</mo><mo 
class="MathClass-open" stretchy="false">&#x0028;</mo><msub><mrow 
><mstyle mathvariant="bold"><mi 
>s</mi></mstyle></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close" stretchy="false">&#x0029;</mo> <mo 
class="MathClass-rel">=</mo><msub><mrow 
> <mstyle mathvariant="bold"><mi 
>k</mi></mstyle></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">&#x21D4;</mo><msub><mrow 
><mstyle mathvariant="bold"><mi 
>C</mi></mstyle></mrow><mrow 
><mi 
>k</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-rel">&#x003C;</mo><msub><mrow 
> <mstyle mathvariant="bold"><mi 
>s</mi></mstyle></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">&#x2264;</mo><msub><mrow 
><mstyle mathvariant="bold"><mi 
>C</mi></mstyle></mrow><mrow 
><mi 
>k</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">&#x0028;1&#x0029;</td></tr></table>
<!--l. 35--><p class="indent" >   The inverse quantizer <!--l. 35--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>Q</mi></mrow><mrow 
><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msup 
></math>
estimates <!--l. 35--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mstyle mathvariant="bold"><mi 
>s</mi></mstyle></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math>
knowing <!--l. 36--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mstyle mathvariant="bold"><mi 
>k</mi></mstyle></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math>
and possibly the PDF &#x0028;Probability Density Function&#x0029;
<!--l. 37--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>p</mi></mrow><mrow 
><mstyle mathvariant="bold"><mi 
>S</mi></mstyle></mrow></msub 
><mo 
class="MathClass-open" stretchy="false">&#x0028;</mo><mstyle mathvariant="bold"><mi 
>s</mi></mstyle><mo 
class="MathClass-close" stretchy="false">&#x0029;</mo></math>, using a
reconstruction level <!--l. 37--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mstyle mathvariant="bold"><mi 
>r</mi></mstyle></mrow><mrow 
><mi 
>k</mi></mrow></msub 
> <mo 
class="MathClass-rel">&#x2208;</mo><mo 
class="MathClass-close" stretchy="false">&#x005D;</mo><msub><mrow 
><mstyle mathvariant="bold"><mi 
>C</mi></mstyle></mrow><mrow 
><mi 
>k</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mstyle mathvariant="bold"><mi 
>C</mi></mstyle></mrow><mrow 
><mi 
>k</mi></mrow></msub 
><mo 
class="MathClass-close" stretchy="false">&#x005D;</mo></math>,
generating the output </p><table class="equation"><tr><td>
<!--l. 39--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                             <mstyle 
   id="x1-2004r2"  class="label" ></mstyle><!--endlabel--><msub><mrow 
><mo 
class="MathClass-open" stretchy="false"><mover 
accent="true"><mrow 
><mstyle mathvariant="bold">s</mstyle></mrow><mo accent="true">&#x007E;</mo></mover></mo></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo><msub><mrow 
> <mstyle mathvariant="bold"><mi 
>r</mi></mstyle></mrow><mrow 
><mi 
>k</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">&#x0028;2&#x0029;</td></tr></table>
<!--l. 43--><p class="indent" >   The smallest and the highest value of all
<!--l. 43--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mstyle mathvariant="bold"><mi 
>C</mi></mstyle></mrow><mrow 
><mi 
>k</mi></mrow></msub 
></math> are called the decision
boundaries of <!--l. 44--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Q</mi></math>.
Therefore,
                                                                  

                                                                  
</p>
   <h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x1-30002"></a>Uniform SQ &#x0028;USQ&#x0029;</h3>
<!--l. 51--><p class="noindent" >In an USQ, all decision levels are equally spaced by a distance known as <span 
class="ecti-1000">the Quantization Step</span>
<span 
class="ecti-1000">Size </span>&#x0028;QSS&#x0029; <!--l. 52--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="normal">&#x0394;</mi></math>,
satis&#xFB01;ying that the domain of the input signal is divided into intervals of constant
size </p><table class="equation"><tr><td>
<!--l. 55--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                      <mstyle 
   id="x1-3001r3"  class="label" ></mstyle><!--endlabel--><mi mathvariant="normal">&#x0394;</mi> <mo 
class="MathClass-rel">=</mo><msub><mrow 
> <mstyle mathvariant="bold"><mi 
>d</mi></mstyle></mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo><msub><mrow 
><mstyle mathvariant="bold"><mi 
>d</mi></mstyle></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo><msub><mrow 
> <mstyle mathvariant="bold"><mi 
>r</mi></mstyle></mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">&#x2212;</mo><msub><mrow 
><mstyle mathvariant="bold"><mi 
>r</mi></mstyle></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-punc">,</mo>
</math></td><td class="eq-no">&#x0028;3&#x0029;</td></tr></table>
<!--l. 58--><p class="indent" >   where <!--l. 58--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mstyle mathvariant="bold"><mi 
>d</mi></mstyle></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math> is
the <!--l. 58--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi></math>-th decision
level and <!--l. 58--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mstyle mathvariant="bold"><mi 
>r</mi></mstyle></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math>
is the <!--l. 59--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi></math>-th
representation level.
</p><!--l. 71--><p class="indent" >   In USQs, the quantization error <!--l. 71--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="bold"><mi 
>e</mi></mstyle></math>
depends on <!--l. 71--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="normal">&#x0394;</mi></math>
and can be modeled as a noise signal that: &#x0028;1&#x0029; is uncorrelated to the input
<!--l. 73--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="bold"><mi 
>s</mi></mstyle></math>, &#x0028;2&#x0029; is
<a 
href="https://en.wikipedia.org/wiki/White_noise" >white</a> and therefore, &#x0028;3&#x0029; it follows a uniform distribution.
</p><!--l. 94--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.1   </span> <a 
 id="x1-40002.1"></a>Mid-rise USQ</h4>
<!--l. 97--><p class="noindent" >In mid-rise quantizers the reconstructed signal
<!--l. 97--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mstyle mathvariant="bold"><mi 
>s</mi></mstyle></mrow><mo accent="true">&#x007E;</mo></mover></math> never is
0, even if <!--l. 98--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mstyle mathvariant="bold"><mi 
>s</mi></mstyle></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></math>
for any <!--l. 98--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi></math>.
The mapping process in a mid-rise quantizer can be described as </p><table class="equation"><tr><td>
                                                                  

                                                                  
<!--l. 100--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                             <mstyle 
   id="x1-4001r4"  class="label" ></mstyle><!--endlabel--><msub><mrow 
><mo 
class="MathClass-open" stretchy="false"><mstyle mathvariant="bold">k</mstyle></mo></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mstyle mathsize="1.61em"><mrow><mo fence="true" form="prefix"> &#x230A;</mo><mrow></mrow><mo fence="true" form="postfix"></mo></mrow></mstyle><mfrac><mrow 
><msub><mrow 
><mstyle mathvariant="bold"><mi 
>s</mi></mstyle></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow> 
<mrow 
><mi mathvariant="normal">&#x0394;</mi></mrow></mfrac> <mstyle mathsize="1.61em"><mrow><mo fence="true" form="prefix"> &#x230B;</mo><mrow></mrow><mo fence="true" form="postfix"></mo></mrow></mstyle><mo 
class="MathClass-punc">,</mo>
</math></td><td class="eq-no">&#x0028;4&#x0029;</td></tr></table>
<!--l. 104--><p class="indent" >   and the inverse mapping by </p><table class="equation"><tr><td>
<!--l. 105--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                           <mstyle 
   id="x1-4002r5"  class="label" ></mstyle><!--endlabel--><msub><mrow 
><mo 
class="MathClass-open" stretchy="false"><mover 
accent="true"><mrow 
><mstyle mathvariant="bold">s</mstyle></mrow><mo accent="true">&#x007E;</mo></mover></mo></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mi mathvariant="normal">&#x0394;</mi><mstyle mathsize="1.61em"><mrow><mo fence="true" form="prefix"> (</mo><mrow></mrow><mo fence="true" form="postfix"></mo></mrow></mstyle><msub><mrow 
><mstyle mathvariant="bold"><mi 
>k</mi></mstyle></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn></mrow></mfrac><mstyle mathsize="1.61em"><mrow><mo fence="true" form="prefix"> )</mo><mrow></mrow><mo fence="true" form="postfix"></mo></mrow></mstyle><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">&#x0028;5&#x0029;</td></tr></table>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
                                                                  

                                                                  
<!--l. 111--><p class="noindent" ><div style="text-align:center;"> <img width=600pt src="graphics/midrise.svg" /> </div>  <a 
 id="x1-4003r2"></a>
<a 
 id="x1-4004"></a>
<br />                                                                  </p><div class="caption" 
><span class="id">
Figure&#x00A0;2:    </span><span  
class="content">An    uniform    mid-rise    quantizer    &#x0028;see    the    <a 
href="https://nbviewer.jupyter.org/github/vicente-gonzalez-ruiz/scalar_quantization/blob/master/graphics/midrise.ipynb" >notebook</a>&#x0029;.
<!--l. 117--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="normal">&#x0394;</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn></math>
and <!--l. 117--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>K</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mn>3</mn></math>
&#x0028;the   decision   boundaries   have   been   ignored&#x0029;.   The   decision   levels
&#x0028;<!--l. 117--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="bold"><mi 
>d</mi></mstyle></math>&#x0029;
are <!--l. 117--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open" stretchy="false">&#x007B;</mo><mo 
class="MathClass-rel">&#x22EF;</mo><mspace width="0.17em" class="thinspace"/><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-bin">&#x2212;</mo><mn>3</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-bin">&#x2212;</mo><mn>2</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>2</mn><mo 
class="MathClass-punc">,</mo><mn>3</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-rel">&#x22EF;</mo><mspace width="0.17em" class="thinspace"/><mo 
class="MathClass-close" stretchy="false">&#x007D;</mo></math>
and the representation levels &#x0028;<!--l. 117--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="bold"><mi 
>r</mi></mstyle></math>&#x0029;
are <!--l. 117--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open" stretchy="false">&#x007B;</mo><mo 
class="MathClass-rel">&#x22EF;</mo><mspace width="0.17em" class="thinspace"/><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-bin">&#x2212;</mo><mn>2</mn><mo 
class="MathClass-punc">.</mo><mn>5</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn><mo 
class="MathClass-punc">.</mo><mn>5</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-bin">&#x2212;</mo><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>5</mn><mo 
class="MathClass-punc">,</mo><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>5</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn><mo 
class="MathClass-punc">.</mo><mn>5</mn><mo 
class="MathClass-punc">,</mo><mn>2</mn><mo 
class="MathClass-punc">.</mo><mn>5</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-rel">&#x22EF;</mo><mspace width="0.17em" class="thinspace"/><mo 
class="MathClass-close" stretchy="false">&#x007D;</mo></math>.
</span></div><!--tex4ht:label?: x1-4003r2 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">2.2   </span> <a 
 id="x1-50002.2"></a>Mid-tread USQ</h4>
<!--l. 125--><p class="noindent" >In mid-tread quantizers the reconstructed signal is
<!--l. 125--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn></math> when
<!--l. 125--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mstyle mathvariant="bold"><mi 
>s</mi></mstyle></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></math>. The
mapping process in a mid-tread quantizer can be described as </p><table class="equation"><tr><td>
<!--l. 127--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                           <mstyle 
   id="x1-5001r6"  class="label" ></mstyle><!--endlabel--><msub><mrow 
><mo 
class="MathClass-open" stretchy="false"><mstyle mathvariant="bold">k</mstyle></mo></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="normal"><mi 
>r</mi><mi 
>o</mi><mi 
>u</mi><mi 
>n</mi><mi 
>d</mi></mstyle><mstyle mathsize="1.61em"><mrow><mo fence="true" form="prefix"> (</mo><mrow></mrow><mo fence="true" form="postfix"></mo></mrow></mstyle><mfrac><mrow 
><msub><mrow 
><mstyle mathvariant="bold"><mi 
>s</mi></mstyle></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow> 
<mrow 
><mi mathvariant="normal">&#x0394;</mi></mrow></mfrac> <mstyle mathsize="1.61em"><mrow><mo fence="true" form="prefix"> )</mo><mrow></mrow><mo fence="true" form="postfix"></mo></mrow></mstyle><mo 
class="MathClass-punc">,</mo>
</math></td><td class="eq-no">&#x0028;6&#x0029;</td></tr></table>
<!--l. 131--><p class="indent" >   and the inverse mapping by </p><table class="equation"><tr><td>
<!--l. 132--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                             <mstyle 
   id="x1-5002r7"  class="label" ></mstyle><!--endlabel--><msub><mrow 
><mo 
class="MathClass-open" stretchy="false"><mover 
accent="true"><mrow 
><mstyle mathvariant="bold">s</mstyle></mrow><mo accent="true">&#x007E;</mo></mover></mo></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mi mathvariant="normal">&#x0394;</mi><msub><mrow 
><mstyle mathvariant="bold"><mi 
>k</mi></mstyle></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">&#x0028;7&#x0029;</td></tr></table>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
                                                                  

                                                                  
<!--l. 138--><p class="noindent" ><div style="text-align:center;"> <img width=600pt src="graphics/midtread.svg" /> </div>  <a 
 id="x1-5003r3"></a>
<a 
 id="x1-5004"></a>
<br />                                                                  </p><div class="caption" 
><span class="id">
Figure&#x00A0;3:    </span><span  
class="content">An    uniform    mid-tread    quantizer    &#x0028;see    the    <a 
href="https://nbviewer.jupyter.org/github/vicente-gonzalez-ruiz/scalar_quantization/blob/master/graphics/midtread.ipynb" >notebook</a>&#x0029;.
<!--l. 144--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="normal">&#x0394;</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn></math>
and <!--l. 144--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>K</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mn>2</mn></math>
&#x0028;the   decision   boundaries   have   been   ignored&#x0029;.   The   decision   levels
&#x0028;<!--l. 144--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="bold"><mi 
>d</mi></mstyle></math>&#x0029;
are <!--l. 144--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open" stretchy="false">&#x007B;</mo><mo 
class="MathClass-rel">&#x22EF;</mo><mspace width="0.17em" class="thinspace"/><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-bin">&#x2212;</mo><mn>2</mn><mo 
class="MathClass-punc">.</mo><mn>5</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn><mo 
class="MathClass-punc">.</mo><mn>5</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-bin">&#x2212;</mo><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>5</mn><mo 
class="MathClass-punc">,</mo><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>5</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn><mo 
class="MathClass-punc">.</mo><mn>5</mn><mo 
class="MathClass-punc">,</mo><mn>2</mn><mo 
class="MathClass-punc">.</mo><mn>5</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-rel">&#x22EF;</mo><mspace width="0.17em" class="thinspace"/><mo 
class="MathClass-close" stretchy="false">&#x007D;</mo></math>
and the representation levels &#x0028;<!--l. 144--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="bold"><mi 
>r</mi></mstyle></math>&#x0029;
are <!--l. 144--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open" stretchy="false">&#x007B;</mo><mo 
class="MathClass-rel">&#x22EF;</mo><mspace width="0.17em" class="thinspace"/><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-bin">&#x2212;</mo><mn>2</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-bin">&#x2212;</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>2</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-rel">&#x22EF;</mo><mspace width="0.17em" class="thinspace"/><mo 
class="MathClass-close" stretchy="false">&#x007D;</mo></math>.
</span></div><!--tex4ht:label?: x1-5003r2 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">2.3   </span> <a 
 id="x1-60002.3"></a>Mid-tread USQ with deadzone</h4>
<!--l. 152--><p class="noindent" >In a USQwD &#x0028;USQ with Deadzone&#x0029;, the quantization step is
<!--l. 152--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>2</mn><mi mathvariant="normal">&#x0394;</mi></math> for
<!--l. 153--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mstyle mathvariant="bold"><mi 
>s</mi></mstyle></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></math>.
Deadzone quantizers tends to remove the <a 
href="https://en.wikipedia.org/wiki/Noise_(electronics)" >electronic noise</a> &#x0028;that
usually has a small amplitude compared to the input signal
<!--l. 156--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="bold"><mi 
>s</mi></mstyle></math>&#x0029;,
precisely where the <a 
href="https://en.wikipedia.org/wiki/Signal-to-noise_ratio" >SNR &#x0028;Signal-to-Noise Ratio&#x0029;</a> is the
lowest.<span class="footnote-mark"><a 
href="index2.html#fn1x0"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-6001f1"></a> 
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
                                                                  

                                                                  
<!--l. 163--><p class="noindent" ><div style="text-align:center;"> <img width=600pt src="graphics/deadzone.svg" /> </div>  <a 
 id="x1-6002r4"></a>
<a 
 id="x1-6003"></a>
<br />                                                                  </p><div class="caption" 
><span class="id">
Figure&#x00A0;4:    </span><span  
class="content">An    uniform    deadzone    quantizer    &#x0028;see    the    <a 
href="https://nbviewer.jupyter.org/github/vicente-gonzalez-ruiz/scalar_quantization/blob/master/graphics/deadzone.ipynb" >notebook</a>&#x0029;.
<!--l. 169--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="normal">&#x0394;</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn></math>
and <!--l. 169--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>K</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mn>2</mn></math>
&#x0028;the   decision   boundaries   have   been   ignored&#x0029;.   The   decision   levels
&#x0028;<!--l. 169--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="bold"><mi 
>d</mi></mstyle></math>&#x0029;
are <!--l. 169--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open" stretchy="false">&#x007B;</mo><mo 
class="MathClass-rel">&#x22EF;</mo><mspace width="0.17em" class="thinspace"/><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-bin">&#x2212;</mo><mn>3</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-bin">&#x2212;</mo><mn>2</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>2</mn><mo 
class="MathClass-punc">,</mo><mn>3</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-rel">&#x22EF;</mo><mspace width="0.17em" class="thinspace"/><mo 
class="MathClass-close" stretchy="false">&#x007D;</mo></math>
and the representation levels &#x0028;<!--l. 169--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="bold"><mi 
>r</mi></mstyle></math>&#x0029;
are <!--l. 169--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open" stretchy="false">&#x007B;</mo><mo 
class="MathClass-rel">&#x22EF;</mo><mspace width="0.17em" class="thinspace"/><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-bin">&#x2212;</mo><mn>2</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-bin">&#x2212;</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>2</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-rel">&#x22EF;</mo><mspace width="0.17em" class="thinspace"/><mo 
class="MathClass-close" stretchy="false">&#x007D;</mo></math>.
</span></div><!--tex4ht:label?: x1-6002r2 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <h3 class="sectionHead"><span class="titlemark">3   </span> <a 
 id="x1-70003"></a>Non-uniform quantization</h3>
<!--l. 177--><p class="noindent" >Uniform quantizers are e&#xFB03;cient &#x0028;minimize the distortion&#x0029; only if the input
samples &#x0028;gray-scale values of the pixels&#x0029; are uniformly distributed among
the quantization <a 
href="https://en.wikipedia.org/wiki/Data_binning" >bins</a>&#x00A0;<span class="cite">&#x005B;<a 
href="#Xvruiz__scalar_quantization">1</a>&#x005D;</span>. However, when the probability of the samples
is not &#x201C;&#xFB02;at&#x201D; &#x0028;or the number of bins is small compared to the number
of possible input values&#x0029;, we can use better quantizers. For example, if we
know that most of the samples are small integer values &#x0028;positive and
negative<span class="footnote-mark"><a 
href="index3.html#fn2x0"><sup class="textsuperscript">2</sup></a></span><a 
 id="x1-7001f2"></a> &#x0029;,
a quantizer such as <a 
href="https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/contents/gray_SQ/gray_SQ_companded.ipynb" >gray_SQ_companded.ipynb</a> can be more suitable than an uniform
one<span class="footnote-mark"><a 
href="index4.html#fn3x0"><sup class="textsuperscript">3</sup></a></span><a 
 id="x1-7002f3"></a> .
</p><!--l. 190--><p class="indent" >   If we know that the input signal <!--l. 190--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="bold"><mi 
>s</mi></mstyle></math>
does not follow an uniform distribution, it is possible to use a variable
<!--l. 191--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="normal">&#x0394;</mi></math> to minimize the
quantization error <!--l. 192--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="bold"><mi 
>e</mi></mstyle></math>
in those samples that are more probable.
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.1   </span> <a 
 id="x1-80003.1"></a>Companded quantization&#x00A0;<span class="cite">&#x005B;<a 
href="#Xsayood2017introduction">6</a>&#x005D;</span></h4>
<!--l. 200--><p class="noindent" ><a 
href="https://en.wikipedia.org/wiki/Companding" >Companding</a> &#x0028;COMpressing + exPANDING&#x0029; quantization is
used when most of the samples are concentrated arround the
<!--l. 202--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn></math> value.
For example, most of the &#x0028;interesting&#x0029; audio for humans has a low volume &#x0028;for this
reason, companded quantizers are used in telephony&#x0029;.
</p><!--l. 206--><p class="indent" >   In a companded codec, the original signal is mapped through a
compressor, quantized using an uniform quantized, and re-mapped using the
corresponding expander, resulting in a logarithmic quantization, centered at
<!--l. 209--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn></math>. A good example
is the <a 
href="https://en.wikipedia.org/wiki/%CE%9C-law_algorithm" ><!--l. 210--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x03BC;</mi></mrow></math>-law</a>
codec.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
                                                                  

                                                                  
<!--l. 215--><p class="noindent" ><div style="text-align:center;"> <img width=600 src="graphics/ulaw-compressor.svg" /> </div>  <div style="text-align:center;"> <img width=600 src="graphics/ulaw-expander.svg" /> </div>   <div style="text-align:center;"> <img width=600 src="graphics/companded.svg" /> </div>   <a 
 id="x1-8001r5"></a>
<a 
 id="x1-8002"></a>
<br />                                                                  </p><div class="caption" 
><span class="id">
Figure&#x00A0;5: </span><span  
class="content">Insights of a companded quantizer/dequantizer. See this <a 
href="https://nbviewer.jupyter.org/github/vicente-gonzalez-ruiz/scalar_quantization/blob/master/graphics/companded_quantization.ipynb" >notebook</a>.  </span></div><!--tex4ht:label?: x1-8001r3 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">3.2   </span> <a 
 id="x1-90003.2"></a>PDF-optimized quantization</h4>
<!--l. 228--><p class="noindent" >This non-uniform quantizer is a generalization of the companded quantizer,
where the input samples can follow any distribution. Now, with the idea
of minimizing the distortion &#x0028;in general, in terms of the <a 
href="https://en.wikipedia.org/wiki/Mean_squared_error" >MSE</a>&#x0029;, we chose
<!--l. 232--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mstyle mathvariant="bold"><mi mathvariant="normal">&#x0394;</mi></mstyle></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math>
smaller where signal samples appear most o&#xFB00;en.
</p><!--l. 235--><p class="indent" >   The most used PDF quantizer is the Max-Lloyd quantizer&#x00A0;<span class="cite">&#x005B;<a 
href="#Xlloyd1982least">5</a>&#x005D;</span>, whose authors
developed an iterative algorithm for determining the decision and representation
levels.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
                                                                  

                                                                  
<!--l. 241--><p class="noindent" ><div style="text-align:center;"> <img width=600 src="graphics/cuantif_max-lloyd.svg" /> </div>  <a 
 id="x1-9001r6"></a>
<a 
 id="x1-9002"></a>
<br />                                                                  </p><div class="caption" 
><span class="id">
Figure&#x00A0;6: </span><span  
class="content">A Max-Lloyd quantizer.                                     </span></div><!--tex4ht:label?: x1-9001r3 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
<!--l. 246--><p class="indent" >   Uniform quantizers are e&#xFB03;cient &#x0028;minimize the distortion&#x0029; only if the input
samples &#x0028;gray-scale values of the pixels&#x0029; are uniformly distributed among
the quantization <a 
href="https://en.wikipedia.org/wiki/Data_binning" >bins</a>&#x00A0;<span class="cite">&#x005B;<a 
href="#Xvruiz__scalar_quantization">1</a>&#x005D;</span>. However, when the probability of the samples
is not &#x201C;&#xFB02;at&#x201D; &#x0028;or the number of bins is small compared to the number
of possible input values&#x0029;, we can use better quantizers. For example, if we
know that most of the samples are small integer values &#x0028;positive and
negative<span class="footnote-mark"><a 
href="index5.html#fn4x0"><sup class="textsuperscript">4</sup></a></span><a 
 id="x1-9003f4"></a> &#x0029;,
a quantizer such as <a 
href="https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/contents/gray_SQ/gray_SQ_companded.ipynb" >gray_SQ_companded.ipynb</a> can be more suitable than an uniform
one<span class="footnote-mark"><a 
href="index6.html#fn5x0"><sup class="textsuperscript">5</sup></a></span><a 
 id="x1-9004f5"></a> .
</p><!--l. 259--><p class="indent" >   Notice that the Max-Lloyd quantizer is equivalent to use K-means&#x00A0;<span class="cite">&#x005B;<a 
href="#Xhartigan1979algorithm">3</a>&#x005D;</span> if we known
the <!--l. 260--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>K</mi></math>
parameter &#x0028;the number of representation levels&#x0029;. In this case, the centroids
computed by K-means are in the middle of each region. If we don&#x2019;t know
<!--l. 263--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>K</mi></math>,
we must use the Lloyd Algorithm&#x00A0;<span class="cite">&#x005B;<a 
href="#Xhartigan1979algorithm">3</a>&#x005D;</span>, which also estimates
<!--l. 264--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>K</mi></math>.
</p>
   <h3 class="sectionHead"><span class="titlemark">4   </span> <a 
 id="x1-100004"></a>Adaptive quantization</h3>
<!--l. 271--><p class="noindent" >Adaptive quantizers modify <!--l. 271--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="normal">&#x0394;</mi></math>
dynamically, depending on the local characteristics of
<!--l. 272--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="bold"><mi 
>s</mi></mstyle></math>.
</p><!--l. 276--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">4.1   </span> <a 
 id="x1-110004.1"></a>Forward adaptive quantization</h4>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 281--><p class="noindent" >Used for determining a suitable <!--l. 281--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi mathvariant="normal">&#x0394;</mi></mrow></math>
     for blocks of samples.
     </p></li>
     <li class="itemize">
     <!--l. 282--><p class="noindent" >&#x00A0; <a 
 id="encoder"></a>
                                                                  

                                                                  
</p>
     <h5 class="likesubsubsectionHead"><a 
 id="x1-120004.1"></a>Encoder:</h5>
     <!--l. 286--><p class="noindent" >
         </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-12002x1">
         <!--l. 290--><p class="noindent" >While samples in <!--l. 290--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>:
         </p><!--l. 292--><p class="noindent" >
             </p><ol  class="enumerate2" >
<li 
  class="enumerate" id="x1-12004x1">
             <!--l. 296--><p class="noindent" >Read into <!--l. 296--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>b</mi></mrow></math>
             the next <!--l. 296--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>B</mi></mrow></math>
             samples of <!--l. 296--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>.
             </p></li>
<li 
  class="enumerate" id="x1-12006x2">
             <!--l. 298--><p class="noindent" >Determine <!--l. 298--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi mathvariant="normal">&#x0394;</mi></mrow></math>,
             minimizing the quantization error, and output <!--l. 299--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi mathvariant="normal">&#x0394;</mi></mrow></math>
             &#x0028;or the data necessary for its determination&#x0029;.
             </p></li>
<li 
  class="enumerate" id="x1-12008x3">
             <!--l. 301--><p class="noindent" >Quantize <!--l. 301--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>b</mi></mrow></math>
             and output it.</p></li></ol>
         </li></ol>
     </li>
     <li class="itemize">
     <!--l. 304--><p class="noindent" >&#x00A0; <a 
 id="decoder"></a>
</p>
     <h5 class="likesubsubsectionHead"><a 
 id="x1-130004.1"></a>Decoder:</h5>
     <!--l. 308--><p class="noindent" >
         </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-13002x1">
         <!--l. 312--><p class="noindent" >While data in input:
         </p><!--l. 314--><p class="noindent" >
                                                                  

                                                                  
             </p><ol  class="enumerate2" >
<li 
  class="enumerate" id="x1-13004x1">
             <!--l. 318--><p class="noindent" >Read <!--l. 318--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi mathvariant="normal">&#x0394;</mi></mrow></math>
             &#x0028;or the data necessary for determining it, and in this case, use
             the same algorithm that the used by the encoder&#x0029;.
             </p></li>
<li 
  class="enumerate" id="x1-13006x2">
             <!--l. 321--><p class="noindent" >&#x201C;Dequantize&#x201D; <!--l. 321--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>b</mi></mrow></math>
             and output it &#x0028;note that the dequantization is only a way of
             calling the process of reverting the original range of the quantized
             signal&#x0029;.</p></li></ol>
         </li></ol>
     </li>
     <li class="itemize">
     <!--l. 327--><p class="noindent" >The selection of <!--l. 327--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>B</mi></mrow></math>
     is a trade-o&#xFB00; between the increase in side information needed by small block
     sizes and the loss of &#xFB01;delity due to large block sizes.
     </p></li>
     <li class="itemize">
     <!--l. 331--><p class="noindent" >Forward adaptive quantization generates a
     <!--l. 332--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>B</mi><mstyle 
class="text"><mtext  >-samples</mtext></mstyle> <mo 
class="MathClass-bin">&#x00D7;</mo> <msub><mrow 
><mi 
>f</mi></mrow><mrow 
><mi 
>s</mi></mrow></msub 
></mrow></math> delay &#x0028;bu&#xFB00;ering&#x0029;,
     where <!--l. 332--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>f</mi></mrow><mrow 
><mi 
>s</mi></mrow></msub 
></mrow></math> is the
     sampling rate of <!--l. 333--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>.</p></li></ul>
<!--l. 338--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">5   </span> <a 
 id="x1-140005"></a>Backward adaptive quantization</h3>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 343--><p class="noindent" >Only the previously quantized samples are available to use in adapting the
     quantizer.
     </p></li>
     <li class="itemize">
     <!--l. 346--><p class="noindent" >Idea: If happens that <!--l. 346--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi mathvariant="normal">&#x0394;</mi></mrow></math>
     is smaller than it should be, the input will fall in the outer levels of the
     quantizer a high number of times. On the other hand, if <!--l. 348--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi mathvariant="normal">&#x0394;</mi></mrow></math>
     is larger than it should be, the samples will fall in the inner levels a high
     number of times.
                                                                  

                                                                  
     </p></li>
     <li class="itemize">
     <!--l. 351--><p class="noindent" >&#x00A0; <a 
 id="encoder"></a>
</p>
     <h5 class="likesubsubsectionHead"><a 
 id="x1-150005"></a>Encoder:</h5>
     <!--l. 355--><p class="noindent" >
         </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-15002x1">
         <!--l. 359--><p class="noindent" ><!--l. 359--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi mathvariant="normal">&#x0394;</mi> <mo 
class="MathClass-rel">&#x2190;</mo> <mn>2</mn></mrow></math>.
         </p></li>
<li 
  class="enumerate" id="x1-15004x2">
         <!--l. 361--><p class="noindent" >While <!--l. 361--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>
         is not exhausted:
         </p><!--l. 363--><p class="noindent" >
             </p><ol  class="enumerate2" >
<li 
  class="enumerate" id="x1-15006x1">
             <!--l. 367--><p class="noindent" >Quantize the next sample.
             </p></li>
<li 
  class="enumerate" id="x1-15008x2">
             <!--l. 369--><p class="noindent" >Observe the output and re&#xFB01;ne <!--l. 369--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi mathvariant="normal">&#x0394;</mi></mrow></math>.</p></li></ol>
         </li></ol>
     </li>
     <li class="itemize">
     <!--l. 372--><p class="noindent" >&#x00A0; <a 
 id="decoder"></a>
</p>
     <h5 class="likesubsubsectionHead"><a 
 id="x1-160005"></a>Decoder:</h5>
     <!--l. 376--><p class="noindent" >
         </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-16002x1">
         <!--l. 380--><p class="noindent" ><!--l. 380--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi mathvariant="normal">&#x0394;</mi> <mo 
class="MathClass-rel">&#x2190;</mo> <mn>2</mn></mrow></math>.
                                                                  

                                                                  
         </p></li>
<li 
  class="enumerate" id="x1-16004x2">
         <!--l. 382--><p class="noindent" >While <!--l. 382--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>&#x015D;</mi></mrow></math>
         is not exhausted:
         </p><!--l. 384--><p class="noindent" >
             </p><ol  class="enumerate2" >
<li 
  class="enumerate" id="x1-16006x1">
             <!--l. 388--><p class="noindent" >&#x201C;Dequantize&#x201D; the next sample.
             </p></li>
<li 
  class="enumerate" id="x1-16008x2">
             <!--l. 390--><p class="noindent" >Step 2.B of the encoder.</p></li></ol>
         </li></ol>
     </li></ul>
<!--l. 397--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.1   </span> <a 
 id="x1-170005.1"></a>The Jayant quantizer&#x00A0;<span class="cite">&#x005B;<a 
href="#Xjayant1974digital">4</a>&#x005D;</span></h4>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 402--><p class="noindent" >Adaptive quantization with a one word memory &#x0028;<!--l. 402--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi mathvariant="normal">&#x0394;</mi></mrow><mrow 
><mo 
class="MathClass-open" stretchy="false">&#x0028;</mo><mi 
>t</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn><mo 
class="MathClass-close" stretchy="false">&#x0029;</mo></mrow></msub 
></mrow></math>&#x0029;.
     </p></li>
     <li class="itemize">
     <!--l. 404--><p class="noindent" >A Jayant quantider de&#xFB01;nes the Step 2.B. as: De&#xFB01;ne a multiplier <!--l. 405--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>M</mi></mrow><mrow 
><mi 
>l</mi></mrow></msub 
></mrow></math>
     for each quantization level <!--l. 405--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>l</mi></mrow></math>,
     where for the inner levels <!--l. 406--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>M</mi></mrow><mrow 
><mi 
>l</mi></mrow></msub 
> <mo 
class="MathClass-rel">&#x003C;</mo> <mn>1</mn></mrow></math>
     and for the outer levels <!--l. 406--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msub><mrow 
><mi 
>M</mi></mrow><mrow 
><mi 
>l</mi></mrow></msub 
> <mo 
class="MathClass-rel">&#x003E;</mo> <mn>1</mn></mrow></math>,
     and compute:
</p>
     <table class="equation-star"><tr><td>
                                                                  

                                                                  
     <!--l. 408--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                      <msup><mrow 
><mi mathvariant="normal">&#x0394;</mi></mrow><mrow 
><mo 
class="MathClass-open" stretchy="false">&#x005B;</mo><mi 
>n</mi><mo 
class="MathClass-close" stretchy="false">&#x005D;</mo></mrow></msup 
> <mo 
class="MathClass-rel">=</mo><msup><mrow 
> <mi mathvariant="normal">&#x0394;</mi></mrow><mrow 
><mo 
class="MathClass-open" stretchy="false">&#x005B;</mo><mi 
>n</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn><mo 
class="MathClass-close" stretchy="false">&#x005D;</mo></mrow></msup 
><msup><mrow 
><msub><mrow 
><mi 
>M</mi></mrow><mrow 
>
<mi 
>l</mi></mrow></msub 
></mrow><mrow 
><mo 
class="MathClass-open" stretchy="false">&#x005B;</mo><mi 
>n</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn><mo 
class="MathClass-close" stretchy="false">&#x005D;</mo></mrow></msup 
><mo 
class="MathClass-punc">,</mo>
</math></td></tr></table>
     <!--l. 412--><p class="noindent" >where <!--l. 412--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi mathvariant="normal">&#x0394;</mi></mrow><mrow 
><mo 
class="MathClass-open" stretchy="false">&#x005B;</mo><mi 
>n</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn><mo 
class="MathClass-close" stretchy="false">&#x005D;</mo></mrow></msup 
></mrow></math>
     was the previous quantization step and <!--l. 413--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><msub><mrow 
><mi 
>M</mi></mrow><mrow 
><mi 
>l</mi></mrow></msub 
></mrow><mrow 
><mo 
class="MathClass-open" stretchy="false">&#x005B;</mo><mi 
>n</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn><mo 
class="MathClass-close" stretchy="false">&#x005D;</mo></mrow></msup 
></mrow></math>
     the level multiplier for the <!--l. 413--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mn>1</mn></mrow></math>-th
     &#x0028;previous&#x0029; sample. Thus, if the previous &#x0028;<!--l. 414--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>n</mi> <mo 
class="MathClass-bin">&#x2212;</mo> <mn>1</mn></mrow></math>&#x0029;
     quantization used a <!--l. 415--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi mathvariant="normal">&#x0394;</mi></mrow><mrow 
><mo 
class="MathClass-open" stretchy="false">&#x005B;</mo><mi 
>n</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn><mo 
class="MathClass-close" stretchy="false">&#x005D;</mo></mrow></msup 
></mrow></math>
     too small &#x0028;using outer quantization levels&#x0029; then <!--l. 416--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><msup><mrow 
><mi mathvariant="normal">&#x0394;</mi></mrow><mrow 
><mo 
class="MathClass-open" stretchy="false">&#x005B;</mo><mi 
>n</mi><mo 
class="MathClass-close" stretchy="false">&#x005D;</mo></mrow></msup 
></mrow></math>
     will be larger and viceversa.
     </p></li>
     <li class="itemize">
     <!--l. 418--><p class="noindent" >Depending on the multipliers <!--l. 418--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>M</mi></mrow></math>,
     the quantizer will converge or oscillate. In the &#xFB01;rst case, the quantizer will
     be good for small variations of <!--l. 420--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>
     but bad when a fast adaption to large changes in <!--l. 421--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>
     is required. In the second one, the quantizer will adapt quickly to fast
     variations of <!--l. 422--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>
     but will oscillate when <!--l. 422--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>
     changles slowly.
     </p></li>
     <li class="itemize">
     <!--l. 425--><p class="noindent" >Most Jayant quantizers clip the computation of <!--l. 425--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi mathvariant="normal">&#x0394;</mi></mrow></math>
     to avoid generating a zero output quantizer in those contexts where <!--l. 426--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow 
><mi 
>s</mi></mrow></math>
     is zero or very close to zero, and to improve the adaptation to smaller
     samples after a sequence of bigger ones &#x0028;avoiding to grow without limit&#x0029;:
</p>
     <table class="equation-star"><tr><td>
                                                                  

                                                                  
     <!--l. 431--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
 <mtable  align="axis" style=""  
equalrows="false" columnlines="none" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >if</mtext></mstyle><mi 
>&#x00A0;</mi><msup><mrow 
><mi mathvariant="normal">&#x0394;</mi></mrow><mrow 
><mo 
class="MathClass-open" stretchy="false">&#x005B;</mo><mi 
>n</mi><mo 
class="MathClass-close" stretchy="false">&#x005D;</mo></mrow></msup 
> <mo 
class="MathClass-rel">&#x003C;</mo><msub><mrow 
> <mi mathvariant="normal">&#x0394;</mi></mrow><mrow 
><mstyle 
class="text"><mtext  >min</mtext></mstyle></mrow></msub 
><mi 
>&#x00A0;</mi><mstyle 
class="text"><mtext  >then</mtext></mstyle><mi 
>&#x00A0;</mi><msup><mrow 
><mi mathvariant="normal">&#x0394;</mi></mrow><mrow 
><mo 
class="MathClass-open" stretchy="false">&#x005B;</mo><mi 
>n</mi><mo 
class="MathClass-close" stretchy="false">&#x005D;</mo></mrow></msup 
> <mo 
class="MathClass-rel">=</mo><msub><mrow 
> <mi mathvariant="normal">&#x0394;</mi></mrow><mrow 
><mstyle 
class="text"><mtext  >min</mtext></mstyle></mrow></msub 
><mo 
class="MathClass-punc">,</mo>  </mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="left"> <mstyle 
class="text"><mtext  >if</mtext></mstyle><mi 
>&#x00A0;</mi><msup><mrow 
><mi mathvariant="normal">&#x0394;</mi></mrow><mrow 
><mo 
class="MathClass-open" stretchy="false">&#x005B;</mo><mi 
>n</mi><mo 
class="MathClass-close" stretchy="false">&#x005D;</mo></mrow></msup 
> <mo 
class="MathClass-rel">&#x003E;</mo><msub><mrow 
> <mi mathvariant="normal">&#x0394;</mi></mrow><mrow 
><mstyle 
class="text"><mtext  >max</mtext></mstyle></mrow></msub 
><mi 
>&#x00A0;</mi><mstyle 
class="text"><mtext  >then</mtext></mstyle><mi 
>&#x00A0;</mi><msup><mrow 
><mi mathvariant="normal">&#x0394;</mi></mrow><mrow 
><mo 
class="MathClass-open" stretchy="false">&#x005B;</mo><mi 
>n</mi><mo 
class="MathClass-close" stretchy="false">&#x005D;</mo></mrow></msup 
> <mo 
class="MathClass-rel">=</mo><msub><mrow 
> <mi mathvariant="normal">&#x0394;</mi></mrow><mrow 
><mstyle 
class="text"><mtext  >max</mtext></mstyle></mrow></msub 
><mo 
class="MathClass-punc">.</mo> </mtd></mtr><!--ll--></mtable>
</math></td></tr></table>
     </li></ul>
<!--l. 441--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.2   </span> <a 
 id="x1-180005.2"></a>Adapting with a scale factor</h4>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 446--><p class="noindent" >A Jayant quantized adapts the quantization step to the dynamic range
     of the signa using a set of multipiers. A similar e&#xFB00;ect can be provided by
     dividing the input signal by a scale factor de&#xFB01;ned iteratively as:
</p>
     <table class="equation"><tr><td>
     <!--l. 451--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                      <mstyle 
   id="x1-18001r8"  class="label" ></mstyle><!--endlabel--><msup><mrow 
><mo 
class="MathClass-open" stretchy="false">&#x03B1;</mo></mrow><mrow 
><mo 
class="MathClass-open" stretchy="false">&#x005B;</mo><mi 
>n</mi><mo 
class="MathClass-close" stretchy="false">&#x005D;</mo></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mi 
>&#x03B1;</mi></mrow><mrow 
><mo 
class="MathClass-open" stretchy="false">&#x005B;</mo><mi 
>n</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn><mo 
class="MathClass-close" stretchy="false">&#x005D;</mo></mrow></msup 
><msubsup><mrow 
><mi 
>M</mi></mrow><mrow 
>
<mi 
>l</mi></mrow><mrow 
><mo 
class="MathClass-open" stretchy="false">&#x005B;</mo><mi 
>n</mi><mo 
class="MathClass-bin">&#x2212;</mo><mn>1</mn><mo 
class="MathClass-close" stretchy="false">&#x005D;</mo></mrow></msubsup 
><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">&#x0028;8&#x0029;</td></tr></table>
     </li></ul>
<!--l. 458--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">6   </span> <a 
 id="x1-190006"></a>RD performance</h3>
<!--l. 460--><p class="noindent" >Normaly, RD curves are convex&#x00A0;<span class="cite">&#x005B;<span 
class="ecbx-1000">?</span>&#x005D;</span> &#x0028;this can be seen in the notebooks <a 
href="https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/contents/scalar_quantization/midtread.ipynb" >Midtread
Quantization</a>, <a 
href="https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/contents/scalar_quantization/midrise.ipynb" >Midrise Quantization</a>, <a 
href="https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/contents/scalar_quantization/deadzone.ipynb" >Deadzone Quantization</a>, <a 
href="https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/contents/scalar_quantization/companded.ipynb" >Companded
Quantization</a>, and <a 
href="https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/contents/scalar_quantization/LloydMax.ipynb" >LloydMax Quantization</a>&#x0029;. This means that:
                                                                  

                                                                  
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-19002x1">
     <!--l. 469--><p class="noindent" >At low bit-rates the distortion decreases faster than at high bit-rates.
     </p></li>
<li 
  class="enumerate" id="x1-19004x2">
     <!--l. 471--><p class="noindent" >If we have a <span 
class="ecti-1000">scalable </span>code-stream &#x0028;we can decide how the code-stream will
     be decompressed&#x0029;, we should be aware that some parts of the code-stream
     can minimize faster the RD curve than others.</p></li></ol>
<!--l. 477--><p class="indent" >   As it can be also seen in the notebook <a 
href="https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/contents/scalar_quantization/compare_quantizers.ipynb" >quantizers_comparison</a>, that the performance
of the quantizers is not the same: usually midrise and midtread, performs better than
deadzone at intermediate bit-rates, but deadzone is the best a low bit-rates &#x0028;excluding
Lloyd-Max&#x0029;. Deadzone has also another advantage over midread and midtread: when
<!--l. 483--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="normal">&#x0394;</mi></math> is a
power of 2 &#x0028;which corresponds to a bit-plane encoding&#x0029;, the obtained RD point is
near optimal in the RD space. Finally, the Lloyd-Max Quantizer reaches the highest
performance because it is adaptive.
</p><!--l. 488--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">7   </span> <a 
 id="x1-200007"></a>Perceptual quantization</h3>
<!--l. 491--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">7.1   </span> <a 
 id="x1-210007.1"></a>In audio</h4>
<!--l. 493--><p class="noindent" >An important consideration is the relative perfectual importance of the input
samples. This leads to a weighting of the MSE at the output. The weighting function
can be derived through experiments to determine the &#x201C;level of just noticeable noise&#x201D;.
For example, in subband coding, as expected, high frequecy subbands tolerate more
noise because the HAS &#x0028;Human Auditory System&#x0029; becomes less sensitive at
them.
</p><!--l. 501--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">7.2   </span> <a 
 id="x1-220007.2"></a>In images</h4>
<!--l. 503--><p class="noindent" >Normally, <a 
href="https://en.wikipedia.org/wiki/Visual_system" >humans</a> hardly distinguish more than 64 di&#xFB00;erent <a 
href="https://en.wikipedia.org/wiki/Color" >colors</a>.
                                                                  

                                                                  
</p><!--l. 509--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">8   </span> <a 
 id="x1-230008"></a>Quantization error</h3>
<!--l. 510--><p class="noindent" >The quantization error can be modeled as a random signal
<!--l. 510--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="bold"><mi 
>e</mi></mstyle></math> that is added to the original
one <!--l. 511--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="bold"><mi 
>s</mi></mstyle></math>, and the energy of this
error signal <!--l. 512--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open" stretchy="false">&#x27E8;</mo><mstyle mathvariant="bold"><mi 
>e</mi></mstyle><mo 
class="MathClass-punc">,</mo><mstyle mathvariant="bold"><mi 
>e</mi></mstyle><mo 
class="MathClass-close" stretchy="false">&#x27E9;</mo></math> depends on
the QSS and the values of <!--l. 513--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="bold"><mi 
>s</mi></mstyle></math>.
</p><!--l. 515--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">9   </span> <a 
 id="x1-240009"></a>RD optimized quantizer design</h3>
<!--l. 516--><p class="noindent" >So far, we have designed the image compressor in two steps: &#x0028;1&#x0029; quantize the pixels ...
trying to minimize the distortion, and &#x0028;2&#x0029; entropy encode &#x0028;compress&#x0029; the
quantization indexes. However, if we assume that the entropy encoding performance
is proportional to some rate-prediction metric, such as the entropy, it is possible to
design the quantizer minizing the two RD variables &#x0028;rate and distortion&#x0029; at the same
time&#x00A0;<span class="cite">&#x005B;<a 
href="#Xsayood2017introduction">6</a>&#x005D;</span>.
</p><!--l. 524--><p class="indent" >   However, there is not &#x0028;yet&#x0029; any known reason to think that this approach will be
generate better RD curves that the one in which only the distortion is both
parameters &#x0028;R and D&#x0029; are minimized independently. Besides, the joint optimization
of R and D makes the quantizer dependent of the entropy codec, that reduces the
&#xFB02;exility of the encoding system.
</p><!--l. 531--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">10   </span> <a 
 id="x1-2500010"></a>Resources</h3>
   <div class="thebibliography">
   <p class="bibitem" ><span class="biblabel">
 &#x005B;1&#x005D;<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xvruiz__scalar_quantization"></a>V.&#x00A0;Gonz&#x00E1;lez-Ruiz. <a 
href="https://vicente-gonzalez-ruiz.github.io/scalar_quantization/" >Scalar Quantization</a>.
   </p>
   <p class="bibitem" ><span class="biblabel">
 &#x005B;2&#x005D;<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xvruiz__signal_quantization"></a>V.&#x00A0;Gonz&#x00E1;lez-Ruiz. <a 
href="https://vicente-gonzalez-ruiz.github.io/signal_quantization/" >Signal Quantization</a>.
   </p>
   <p class="bibitem" ><span class="biblabel">
 &#x005B;3&#x005D;<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xhartigan1979algorithm"></a>John&#x00A0;A Hartigan and Manchek&#x00A0;A Wong. <a 
href="https://www.jstor.org/stable/pdf/2346830.pdf?casa_token=OpmDCC-xvB8AAAAA:XsNY6uI435vqjFaoRw_NG8huJq90gTYJ8fqsfwUPZrWiG3Br-eJ-WxftbmDy8ZD7GcFx5STPmU58HnjqbVG8Y-XSK1didSwaovvumCLzYg4Y9CltmX1G" >Algorithm AS 136: A k-means
   clustering algorithm</a>. <span 
class="ecti-1000">Journal of the royal statistical society. series c &#x0028;applied</span>
   <span 
class="ecti-1000">statistics&#x0029;</span>, 28&#x0028;1&#x0029;:100&#x2013;108, 1979.
                                                                  

                                                                  
   </p>
   <p class="bibitem" ><span class="biblabel">
 &#x005B;4&#x005D;<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xjayant1974digital"></a>Nuggehally&#x00A0;S.  Jayant.    <a 
href="https://scholar.google.es/scholar?hl=es&as_sdt=0%2C5&q=%22Digital+coding+of+speech+waveforms%3A+PCM%2C+DPCM%2C+and+DM+quantizers%22&btnG=" >Digital  coding  of  speech  waveforms:  PCM,
   DPCM, and DM quantizers</a>. <span 
class="ecti-1000">Proceedings of the IEEE</span>, 62&#x0028;5&#x0029;:611&#x2013;632, 1974.
   </p>
   <p class="bibitem" ><span class="biblabel">
 &#x005B;5&#x005D;<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xlloyd1982least"></a>Stuart Lloyd.  <a 
href="http://mlsp.cs.cmu.edu/courses/fall2010/class14/lloyd.pdf" >Least squares quantization in PCM</a>.  <span 
class="ecti-1000">IEEE transactions</span>
   <span 
class="ecti-1000">on information theory</span>, 28&#x0028;2&#x0029;:129&#x2013;137, 1982.
   </p>
   <p class="bibitem" ><span class="biblabel">
 &#x005B;6&#x005D;<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xsayood2017introduction"></a>K.&#x00A0;Sayood.    <a 
href="http://rahilshaikh.weebly.com/uploads/1/1/6/3/11635894/data_compression.pdf" ><span 
class="ecti-1000">Introduction  to  Data  Compression</span></a>  <a 
href="https://people.cs.nctu.edu.tw/~cmliu/Courses/Compression/" ><span 
class="ecti-1000">&#x0028;Slides&#x0029;</span></a>.    Morgan
   Kaufmann, 2017.
</p>
   </div>
<a 
 id="Q1-1-32"></a>
    
</body></html> 

                                                                  


